# Kubernetes
- Its the most popular container orchestrator.

## The Architecture
Unpto Container Orchestrator, we use `kubectl` (for ex. to create a deployment) CLI and to manage below it we use `gcloud` (for ex. adding a node pool) CLI.
- Container Images & Configuration
- Container Orchestrator
- Cluster
- VMs

## Practical Exercies
- Create an Autopilot Kubernetes Cluster (my-cluser)
- SSH: Connect to the cluster `gcloud container clusters <cluster-name> get-credentials --location <location-id>`
- SSH: Create a deployment for the hellow-world-rest-api : `kubectl create deployment hello-world-rest-api --image="in28mins/hello-world-rest-api:0.0.1.RELEASE"`
- SSH: List the deployment: `kubectl get deployments`
- SSH: Expose a deployment: `kubectl expose deployment hello-world-rest-api --port 8080 --type LoadBalancer`
- SSH: List the services: `kubectl get services`
- SSH: Watch a service: `kubectl get services --watch`
- SSH: Scale a deployment: `kubectl scale deployment hello-world-rest-api --replicas 10`
- SSH: List the pods: `kubectl get pods`
- SSH: change the number of nodes: `gcloud container clusters resize <cluster-name> --node-pool <pool-name> --num-nodes <number-of-nodes> --region <node-region>`
- SSH: autoscale deployment: `kubectl autoscale deployment <deployment-name> --max <max-replicas> --min <min-replicas> --cpu-percent <cpu-percent>`
- SSH: get the horizontal pod autoscaler: `kubectl get hpa`
- SSH: autoscale the number of nodes in a cluster: `gcloud container cluster <cluster-name> --enable-autoscaling --min-nodes <min-nodes> --max-nodes <max-nodes>`

- SSH: set a configmap for the deployment: `kubectl create configmap <configmap-name> --from-literal=<key>=<value>` 
- SSH: get all configmaps: `kubectl get configmaps`
- SSH: get details (describe) the configmap: `kubectl describe configmap <configmap-name>`

- SSH: set a secret for the deployment: `kubectl create secret generic <secret-name> --from-literal=<key>=<value>` 
- SSH: list all secrets: `kubectl get secrets`
- SSH: get details (describe) the configmap: `kubectl describe secret <secret-name>`

- SSH: create a node-pool and attach it to a cluster: `gcloud container node-pools create <pool-name> --cluster <cluster-name> --region <region-id>`
- SSH: list all node-pools: `gcloud container node-pools list <cluster-name>`

- SSH: change image of a deployment: `kubectl set image deployment <deployment-name> <deployment-name>=<image-details>` for ex. `kubectl set image deployment hello-world-rest-api hello-world-rest-api="in28min/hello-world-rest-api:0.0.2.RELEASE"`

- SSH: get replicasets: `kubectl get replicasets`
- SSH: get pods: `kubectl get pods`
- SSH: get services: `kubectl get services`

## What is a cluster?
A cluster is which contains the nodes.  The nodes are of two types:
- Master Node(s) (control plane)
- Worker Node(s)

## What is a POD?
A pod is the foundational unit of a cluster.  It is on what the deployment is running  and it can contian one or more containers/microservices/deployments (though most ofen, a pod contains only one deployment/container).

## What is a deployment?
The deployment is the code we want to execute or a service that we want to publish.  It is the container image that we want to publish.

## What is a replica-set?
It is what manages versions (sets) of deployments which makes it smooth to switch from one deployment to another.